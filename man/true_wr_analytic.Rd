% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/true_wr_analytic.R
\name{true_wr_analytic}
\alias{true_wr_analytic}
\title{True causal win ratio averaged over covariate patterns}
\usage{
true_wr_analytic(
  X_mat = NULL,
  U_mat = NULL,
  lambda_D,
  kappa_D = 1,
  beta_A_D = NULL,
  beta_X_D = NULL,
  beta_U_D = NULL,
  lambda_H,
  kappa_H = 1,
  beta_A_H = NULL,
  beta_X_H = NULL,
  beta_U_H = NULL,
  lambda_C = NULL,
  beta_A_C = NULL,
  theta_copula = 1,
  phi_admin = NULL,
  rel.tol = 1e-05,
  abs.tol = 1e-08,
  y2_max = Inf,
  fd_step = 1e-04
)
}
\arguments{
\item{X_mat}{numeric matrix N x p; measured covariates; can be NULL if there are no measured covariates}

\item{U_mat}{numeric matrix N x q; unmeasured covariates; can be NULL if there are no unmeasured covariates}

\item{lambda_D}{numeric scalar > 0; baseline hazard rate for the fatal event}

\item{kappa_D}{numeric scalar > 0; Weibull shape parameter for the fatal event; defaults to 1 for exponential}

\item{beta_A_D}{numeric scalar; treatment coefficient for the fatal event; can also be \code{NULL}}

\item{beta_X_D}{numeric vector length p; coefficients for x on the fatal event; can also be \code{NULL}}

\item{beta_U_D}{numeric vector length q; coefficients for u on the fatal event; can also be \code{NULL}}

\item{lambda_H}{numeric scalar > 0; baseline hazard rate for the non-fatal event}

\item{kappa_H}{numeric scalar > 0; Weibull shape parameter for the non-fatal event; defaults to 1 for exponential}

\item{beta_A_H}{numeric scalar; treatment coefficient for the non-fatal event; can also be \code{NULL}}

\item{beta_X_H}{numeric vector length p; coefficients for x on the non-fatal event; can also be \code{NULL}}

\item{beta_U_H}{numeric vector length q; coefficients for u on the non-fatal event; can also be \code{NULL}}

\item{lambda_C}{numeric scalar > 0; baseline hazard rate for random censoring; can also be \code{NULL} for no random censoring}

\item{beta_A_C}{numeric scalar; treatment coefficient for censoring; can also be \code{NULL}}

\item{theta_copula}{numeric scalar >= 1; Gumbelâ€“Hougaard copula parameter (default 1 for independence)}

\item{phi_admin}{numeric scalar > 0; administrative censoring time; can also be \code{NULL} for no administrative censoring}

\item{rel.tol}{numeric scalar; relative tolerance for \code{integrate()}, default 1e-5}

\item{abs.tol}{numeric scalar; absolute tolerance for \code{integrate()}, default 1e-8}

\item{y2_max}{numeric scalar > 0; upper limit for integration in y2; defaults to Inf, or truncated at \code{phi_admin} if non-NULL}

\item{fd_step}{numeric scalar > 0; finite difference step for derivative in y1, default 1e-4}
}
\value{
list with elements:
\describe{
\item{WR}{estimated true causal win ratio}
\item{num}{Monte Carlo estimate of E\link{A(X,U)+B(X,U)}}
\item{den}{Monte Carlo estimate of E\link{C(X,U)+D(X,U)}}
\item{details}{list with vectors A, B, C, D for each row}
}
}
\description{
Compute the true causal win ratio by averaging A(x,u)+B(x,u) and C(x,u)+D(x,u) over covariate patterns (x,u).
The averaging is done over the rows of X_mat and U_mat, treating the empirical distribution of (X,U) as the target distribution.
}
